*Written December, 2022*

Who am I writing this for? I guess myself. It's almost two years since I left. I can say I'm a completely different person than I was then. I feel ready to reflect. But, also, maybe I am writing this for others who are feeling as though they're too far committed down a path that is not turning out to be all that they hoped for. I certainly felt like there was no turning back. I too was you. And I am reluctant to say I found my way out of it.

#### Down the wrong path
In the beginning, I didn't really know where I was going. I was just excited to be going somewhere. For the first time in my life, I really felt validated and recognized for my acheivements. Here I was, a first year PhD student at a great institution. My dad was a college dropout, my mother had a masters in a field she hadn't pursued. For all intensive purposes, I felt like I was reaching for more, making my family proud, being the first in my immediate family to pursue knowledge just a little bit further. 

I'd talk to my father on the phone. Most conversations would start or end with something along the lines of, *"I saw so and so and they were delighted to hear you're doing this. They always thought you were capable."* If you're from a small town, you understand this idea. News travels like light and everyone is caught up in eachother's business. 

In undergraduate, I had won accolades in my studies, advised other students in projects as a TA and in my internship, and had developed some meaningful relationships with faculty who counted on me. I felt a little special in all honesty. I was the only one in my statistics department to be attending a PhD program. To be honest, none of this matters. But in that moment, it really felt like my whole town, undergraduate peers, and mentors were rooting for me and expecting me to succeed. What a silly thought now. 

##### The first year
I had family members calling to check in. How exciting it was. I was living in a house with (my dog and) my friend who I had met the summer before during our REU. We had both been admitted, and in the same lab! What a coincidence and an amazing way to start -- having a buddy in graduate school already. 

I had elected to begin early. I could not wait to get going on my research. Over the past winter, I let them know almost right away that I would be attending, which meant I had time to really get to know some of the faculty in the Computer Vision lab at my school. I was pretty undecided on what I wanted to research -- it all felt so foreign from what I knew and had known. I ended up in this spot probably because of my photography background and some undergraduate projects related to cameras. Deciding early meant that I got to talk to professors, who now knew I was already admitted, undecided on what I wanted to research, and actively looking for a project to work on. 

Looking back on it, that was a bit of a recipe for disaster. I would've pulled the trigger on just about any opportunity without having a real thought about what I'd be studying for the next 4 and a half to potentially 8 years! I ended up narrowing down to two professors, one who I had been setup with by my REU advisor (and maybe a reason for my admittance) and another who had just joined the university, had great energy, and was also really excited just to get going. And, at that time, it seemed I might get to work with both of them. 

Being as excited as I was, I signed up for one of their projects right away. I would be working with the professor who was new to the school. He had visited before but now, he had fully transferred. He was getting ready to take in a bunch of new students since he was essentially starting from the ground up. This was a great opportunity for me. He had funding right away and needed students. He mostly studied biometrics. I did not quite know what that was all about, just that it seemed really popular in this lab, and it usually involved identifying human uniqueness through methods like recognizing faces or how people walked. It sounded exhilerating -- as if we were building spy gadgets, especially when I had to sign an NDA for my first project. Again, how silly of a thought but c'mon I was a fresh college graduate with no understanding of what work in the "real world" or research in academia really looked like. 

In hindsight, one big misconception I had was that I figured that the root of what we were studying was computer vision alone. That, if you were more excited by something later, you could jump around in your study or application of things. I thought "applied research" could be applied elsewhere. It would not be a big deal if I did not absolutely love biometrics. That knowledge could be transferred at no cost to me graduating. I think this might be true for some folks, but I would realize later on that that would not be the case for me.

A few months pass. I had attended conferences in biometrics now, read quite a few papers related to my research topic, and had a pretty good understanding of what the domain looked like. But something was not right. Everyone was really really motivated to do work in the field. A few of the other students in the lab had done a masters in biometrics. Or, they were new to it but were really fascinated with the potential. I had been assigned a partner to work on that summer project with me. We were both first years with very little experience in depth estimation or fingerprint verification, the two main areas we'd be researching. Since he had a much denser math background (a transfer from a math PhD) he was assigned the structure-from-motion aspect of the project. My role was to build a process and tooling for a fingerprint study we would be conducting. This was actually pretty awesome in hindsight. I learned C++ for the first time and used the Verifinger SDK to build a python Tkinter GUI that subjects would use to walkthrough the finger capture process for a 3D fingerprint scanner we had acquired. We were crunching for this deadline when the actual data collection could start. It was stressful, but we made it just barely. 

This is where things really started to get confusing and I could feel something was off. I spent the next few months collecting fingerprint samples from 3 devices for around 400 individuals if I recall correctly. We collected over 120,000 fingerprint samples (for 20 fingers, and 5 capture trials per subject per device). I spent multiple hours a day, multiple days each week in this small room. As an introvert, I met so many people and made, probably pretty poor, small talk this whole time. I felt like I had the same conversation 400 times. I cracked the same corny joke when they'd place their middle finger on the scanner and I'd comforted them when my GUI would fail or when their fingerprints were low quality, which made the process take that much longer. To cut the complaining short, I was tired, exhausted, and already a bit burnt out of fingerprints, but I was supposed to be excited since now we could do the fun stuff. I remember thinking, *"were there any fun stuff to do in fingerprints?"* I had just collected all of this data though. I was determined not to make that time wasted.

It was around this time that my colleague and now friend (the math transfer) was feeling just as burnt out, if not more. He knew that he did not want to study fingerprints any longer. And in his defense, his task of getting the first finger depth reconstructions from this particular model our advisor had recommended had gone pretty poorly. The tool was called Colmap and although you can get great reconstructions with it, the tool was slow, required plenty of tweaking of parameters, and was not robust to the input -- marginal image differences would produce drasticly differing results. For all intensive purposes, this tool required some secret sauce that neither of us could muster to make it function well across many inputs. This all led to him switching advisors. He found a much more fitting project too. I was really happy for him. However, now, it was just on me to carry on with this research project. It was on me to make the most of of all of this, especially all of this time (and money from our grant) spent collecting data.

I had made friends in the program by now. I really felt like I had found a home in the town my school was in. I had a new hobby, new friends, I was busy. More than anything else, I loved hanging out with all of these folks after work. If any of you are reading this now, you really made my time there feel worth it; I miss you all dearly and think of you often. In some ways, these after work convos really got the best of me though. We always talked about research. Some of us were better about pointing this out -- I was not one of them. I really confided in my friends during this period of data collection. The consensus I got was that it will all be so much better once its over. They understood the dread I had already accumulated. I think this masked some of the bitter feelings I had towards biometrics already. Seeing their enthusiasm build in their studies already was confusing but made me optimistic about my future. I really loved my courses, and was ecstatic to finally be learning all about neural networks (wow, how powerful they are). My advisor was so kind-hearted, compassionate, and a role model career-wise. I really did not have much to complain about. But, my uneasiness in my research was looming.

##### The second year
Data collection was long over, but my first summer project was not. This project felt never ending. Before I get into it, you should know that this past year had surprisingly been pretty great. I had settled in really well. There were exciting things to do at the university and in the neighboring area. I had solid friends, was seeing someone, and had met folks outside of the university through soccer, running and cycling. 

If you are in the middle of a graduate program, I highly advise finding friends outside of your bubble. There are a million and one clubs you can join, regardless of how physical you are. I advocate for this because, as my mental health dwindled, these were my only true outlets from the main root of my stress. I would eventually isolate myself from these as well though.

The project was still going on. We were no longer collecting data. Now, we were doing the long awaited "fun stuff". Finally, I had figured out how to create depth estimation models of the finger. This was all thanks to this lesser-known, unpublished research paper from a group studying structure-from-motion as part of a loss function in a neural network. They were measuring depth for autonomous vehicles. Oddly enough, it worked incredibly well for what we were doing, a small win. I say small because it felt incredibly small in the work still required. In a perfect world, this probably could have been an indicator that maybe this work was not for me. My advisor was happy, and ever more excited for this paper we had begun writing. The next stressor that would keep me distracted in the interim was the final deliverable for this project. We had an end date on our grant. It was when my advisor had told the folks funding our project we would be done. In the scheme of it, what an arbitrary date that is when you have no idea if the end result is acheivable. 

Anyway, I had a few really close friends to confide with more regulary about all of this this time. I was living under the roof with one of them, my buddy from the REU, and of course the dog. Not including the dog, this turned out to be not so great for my mental health. While these friends could understand my environment, we had polar opposite opinions on the matter. They understood the hardships, but the fruits of their labor were ever so worth it in their eyes. In mine, it seemed almost all for nothing. I did not care about biometrics. In fact, I had really grown to resent this field. Who was I to be occupying someone else's spot in this lab. The guy from a small town whose concept of security when he left for vacation was leaving the lights on and the door unlocked. This is what I told myself and, in doing so, I had already begun to isolate myself from anyone else in the community. We did not see eye-to-eye was all that I could think.

So, why did I not try switching? This question still haunts me a bit. I will tell you that I honestly tried in some way. I had the scary conversation with my advisor where I told him his research (and I guess mine too at the time) was not for me. That was actually really hard telling a man who had spent years researching in that domain that you had not connected with them and did not have the shared interest. He was great in response though. He proposed that in my next project I could work alongside him with his wife and some psychologists on their passion project. It still involved studying neural networks and also human perception of images output by convolutional layers. It was really fascinating, but I was too far gone to be able to hop on another divergent road and resume a similar routine. I had graduate school shell-shock.

The little light I held on to this whole time was the glimpse of the future I saw where my name was at the top of that published research paper. I did not care what the paper was about. But getting the paper approved to be in a journal or conference would be the affirmation I needed that I could do it (i.e. research), and that I was suppposed to be there (i.e. graduate school). More importantly, it might tell me that I was not on the wrong path. Anyone who has been in a PhD program understands the importance of achieving their first paper acceptance, especially as a first author. It's just I was doing it for all the wrong reasons.

Whatever stamina I had left was teetering fast as the final deliverable deadline loomed closer and closer. We needed a final pipeline -- a process from start to finish that prototyped our method of matching mobile video fingerprint frames to their traditionally captured counterparts with our dataset. This might've been where I started to go off the deep end in terms of how I was working. I was really ineffective. I did not want to be doing this anymore and my body seemed to be telling me indirectly the whole time. I could not focus, I stayed up late and would work late into the night. After finishing the deliverable, I slept in a ton. Sleeping in was like my life hack to avoid the guilt of not doing your work. I was that much closer to 5pm, when the clock striked freedom. However, my internal guilt of not being productive was building and so was my procrastination. 

##### (A quick technical dive)
*Feel free to skip this part if you're not interested in my technical shortcomings training large models for research.*

So what was I doing wrong? It's much easier to diagnose now than it was then. After somehow finishing this pipeline, we had delivered this "bundled" end product to our project funders. Quite unsatisfyingly now, I don't recall if we ever heard back from them about the deliverable. The code was far from perfect so that could be telling but its hard to know if what I built was useful to them after all that work. At the time, my pessimism would suggest things like, maybe they just needed the data and that was all. It was unhealthy to think about. Back to the story. 

I had this simple script that would run every stage of the process from frame extraction, image enhancement, depth reconstruction, and finally, flattening and transforming the finger image. This was all so that it could match the traditional 2D fingerprint counterparts better than an out-of-the-box 3D scanner. Although the pipeline was simple to use -- a requirement of the deliverable, it was so slow. It took ages to run on the whole data set. Lazy me would decide to keep using that deliverable pipeline for parameter optimization after discovering the results were sub-par. We were underperforming to the 3D fingerprint scanner. We eventually realized it was a shortcoming of the data. We had "accepted" far worse quality images (about a 2 out of 5) compared to the 3D scanner (which allowed about a 4 out of 5) during the data collection. Of course, it was that cursed data collection. As a result, we needed a way around this to improve our scores through model tuning and better frame selection.

If you know anything about distributed systems, you can probably see where this next part is going. I never split up these jobs! The process was bottlenecked everywhere. It would flip from being CPU-bound trying to find the most optimal two (high quality) frames to use together for depth reconstruction to too much I/O writing these numpy depth reconstruction files and final fingerprint PNGs. I had tried to optimize a bit. I wrote a fancy script to find equidistant motion in two frames across the dataset by computing the overlap between two of the largest surface areas of the segmentation images (see image below). In addition, I would reuse segmented fingerprint frames in the cropping out of the noise in the depth model and canvasing the final output fingerprints on clean backgrounds. None of this was enough. In addition, I was just intertwining dependencies in the process everywhere. By trying to optimize locally, I had created unwanted dependency that made scaling up even harder.

![pipeline image](./images/pipeline_teaser.png)

As I mentioned, I would run all of the experiments locally at first. I had two GPUs on my personal computer and one on my work computer. I could run a maximum of three tests at a time. I told myself this was enough at first too. We'd get lucky and the next one would be the last and I wouldn't need to worry about any of this anymore. What a little lie. I probably wasted days of my time just waiting. It was bad. For example, if one test failed after 8 hours to say, a "RuntimeError: CUDA error: out of memory" (if you know you know), my experiment was back to square one eight hours later. In the end, I managed to partition the dataset down and send off many jobs with slight parameter tweaking to run in this big cluster of virtual computers my university managed. This was advice my roommates had delivered many times before I finally listened. It would still take days to get results back from a few experiments. This would be my downfall.  

Again, I probably spent days just waiting. At this point, I was not willing to learn how to optimize any further. I could have made more tasks run in parallel on one machine, or investigated where async could have been deployed, or tried handling my I/O better by using more optimal memory management when I did not need to output temporary files. Most importantly, and if you're not doing this already mark my words, I could have output all of the results of the pipeline up until the point where we were still improving upon so that the same work was not inefficiently happening over and over again. 

##### (Back to the story)
There was opportunity everywhere to speed up my work but I simply ignored it. I would let the experiments run their course while I waited. 

I did not do anything productive with my time while jobs were running. Instead, it was my excuse to do other things. I had taught my computer to do all the work for me. When the results came back, I had to guess a little more or a little less in a few variables, hit run again, and then wait to see if the results got any better. And it was glorius. I basically avoided thinking about my research all of the time. I remember telling myself that it was so great; what a toxic idea and it would've been so clear to anyone else that I did not enjoy what I was doing. I would go on runs, bike rides, play soccer, and just about anything else I could do to get out of the house, especially to not see my roommates doing work in their rooms.

By now, my roommates began to speak up on my bad habits. They are such great friends and real troopers for doing so. They wanted the best for me and could see a clear path forward in finishing this project that they knew I was disgusted in at this point. However, I was too ignorant now and of course, took their criticism to heart. The COVID pandemic was isolating enough for the rest world. For me, it allowed me to easily disconnect from my lab and plenty of my peers that provided life and inspiration in my research endeavors. I also lost touch with many of my outlets in the clubs I participated in. I was shutting down. I just had my bubble and when I heard they did not understand why I was trying everything in my power to just be happy, I isolated from them too. The relationship I was in suffered and I could tell I got much harder to be around. 

Internally, I felt like I was dark matter floating around in a field of nothingness. Certain moments might provide momentary joy, but they would inevitably end as my world would return to nihility. I can now diagnose this as depression. It did not abruptly hit me and instead, was a slow burn. Depression sucks the life out of everything you enjoy until your tastes are essentially flavorless. After many nights of tears, the dread of day, and endless distractors of video games, movies, and a little too much insobriety (nothing serious), I realized I needed to get out.

#### Jumping off a moving train
What was I to do if I dropped out? I can't just get a job and keep on coding. I was burnt out more so than I ever had been. What was my identity? I did not know who I was if I was not a PhD student. If you recall, I had let my assumptions about my town, my undergrad, and most of all my friends and family get the best of me. Where was I to go? I was living somewhere that felt comfortable but was neither home nor somewhere I wanted to be if school was not in the picture. All of these thoughts were racing in my mind. And, up until my breaking point, I considered them just part of the overbearing headwind of the path I was on. 

I remember talking to my cousin a few months after eventually dropping out. He had gone through medical school so I was picking his brain during my visit. I was probably digging more than I should of, maybe hoping to hear that what I went through was normal or relatable in some way. He told me one idea I could vividly associate with. He imagined giving up on the path he was on would have felt like "jumping off a moving train".

I exited fast. It was surprisingly pretty easy to dropout. Two emails, one to the head of the computer engineering department and another to my advisor. Very quickly I was on a video call with the head of the department. She was not a woman I knew too well, but she was friendly and was able to gauge my seriousness about the matter. A few emails later and it was finalized mid-semester. I was just two courses from graduating with a masters but, in all honesty, one course would have felt too many. I flew to visit my family as soon as possible. I needed to be close to them and the lockdown had been uplifted. I returned two weeks later with a plan to move out and head back to New York City close to where I grew up. I got an interview at a brewery of all places. It might sound like a peculiar turn of events, but I was really excited to learn more about beer and work in a bar. There's actually a great deal of chemistry behind beer and a boat load of science involved in the craft of making it. Beer also has a really interesting history. You should checkout *A Brewer's Tale* by William Bostwick instead of listen to me ramble on. More importantly, I discovered I had an exit strategy and perhaps a new identity (as an aspiring brewer). I knew how I was going to jump off the train.

#### Closing thoughts
If you've made it this far, I appreciate you for listening. It feels so healthy to talk about and get off my shoulders after all this time. I'd like to end this saying that I've changed a ton since graduating. I am happy now. I still code, and enjoy it. I enjoy beer, but probably was not cut out to make it. I live in NYC with my dog and have found new hobbies to keep me busy.

For all of you that might be feeling similarly in college or work, I promise you there alternative divergent paths everywhere. You always have a choice and folks care about your accomplishments, or criticize the lack thereof, so much less than you probably figure. I found my lab mates, mentors, colleagues, friends, and family, were all supportive knowing that I was doing what I needed to do to be happy.

Life is too short to do what doesn't make you happy.
